{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["'use strict'\n\nimport axios from \"axios\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst formElement = document.querySelector('.form');\nconst inputElement = document.querySelector('.input-text');\nconst loadButton = document.querySelector('.load-btn');\nconst galleryElement = document.querySelector('.gallery');\nconst loadingContainer = document.querySelector('.loading-container');\n\nlet pageNumber = 1;\nlet perPage = 40;\nlet inputValue = ''; \nlet totalHits = 0;\n\nconst api = axios.create({\n    baseURL: \"https://pixabay.com/api/\",\n    params: {\n        key: '41688461-d2a05e0fbe969f7f46dd1fb4f',\n        q: '',\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,  \n        page: pageNumber,\n        per_page: perPage, \n    }\n})\n\nfunction getGalleryCardHeight() {\n    const galleryCard = document.querySelector('.gallery-list');\n    const cardReact = galleryCard.getBoundingClientRect();\n    return cardReact.height; \n}\n\nfunction smoothScrollBy(height) {\n    window.scrollBy({\n        top: height,\n        behavior: 'smooth',\n    })\n}\n\nasync function searchImage(params) {\n    \n    try {\n        const response = await api.get('', {\n            params: params,\n        })\n   \n        const { hits, totalHits: newTotalHits } = response.data;\n\n            if(hits.length > 0) {\n           const rendedImages = hits.reduce((html, \n            {largeImageURL, webformatURL, tags, likes, views, comments, downloads}) => {\n            return html + `\n                <li class='gallery-list'>\n                    <a href='${largeImageURL}'>\n                     <img class='img-element' src='${webformatURL}' alt='${tags}'/>\n                     <div class='gallery-text-wrapper'>\n                     <p>Likes: <span class='img-text'>${likes}</span></p>\n                     <p>Views: <span class='img-text'>${views}</span></p>\n                     <p>Comments: <span class='img-text'>${comments}</span></p>\n                     <p>Downloads: <span class='img-text'>${downloads}</span></p>\n                     </div>\n                    </a>\n                </li>`\n            }, \"\")\n\n            galleryElement.insertAdjacentHTML('beforeend', rendedImages);\n            const simpleBoxContent = new SimpleLightbox ('.gallery a', {\n                captionType: 'attr',\n                captionsData: 'alt',\n                captionDelay: 250, \n                captionPosition: 'bottom',\n                close: true,\n                enableKeyboard: true, \n                docClose: true, \n            })\n\n            simpleBoxContent.refresh();\n            pageNumber += 1;\n            loadButton.style.display = 'flex';\n            \n            if (pageNumber > 2) {\n                const cardHeight = getGalleryCardHeight();\n                smoothScrollBy(2 * cardHeight);\n            }\n          \n            totalHits = newTotalHits;\n\n            if (pageNumber >= Math.ceil(totalHits / perPage)) {\n\n                loadButton.style.display = 'none';\n\n                iziToast.info({\n                    position: 'topRight',\n                    message: `We're sorry, but you've reached the end of search results.`,\n                })\n            }\n\n        } else {\n            iziToast.error({\n                position: 'topRight',\n                message: `Sorry, there are no images matching your search query. Please try again!`,\n            })\n\n            loadButton.style.display = 'none';\n        }\n        }  catch(error) {\n            iziToast.error({\n                title: 'Error',\n                message: error.message,\n                position: 'topRight',\n            })\n        }\n        finally {\n            loadingContainer.style.display = 'none';\n        }\n        \n}\n\n    function loadMoreImages() {\n        inputValue = inputElement.value.trim();\n        const searchParams = new URLSearchParams({\n            ...api.defaults.params,\n            page: pageNumber,\n            q: inputValue,\n        })\n\n        loadingContainer.style.display = 'flex'; \n        loadButton.style.display = 'none'; \n\n        searchImage(searchParams)\n    }\n\n\n    loadButton.addEventListener('click', loadMoreImages)\n\n\n    formElement.addEventListener('submit', event => {\n        event.preventDefault();\n\n        galleryElement.innerHTML = \"\"; \n\n\n        if(galleryElement.innerHTML === \"\") {\n            loadingContainer.style.display = 'flex';\n        }\n\n        pageNumber = 1;\n\n        inputValue = inputElement.value.trim();\n        loadButton.style.display = 'none';\n\n        const params = {\n            ...api.defaults.params,\n            q: inputValue,\n            page: pageNumber,\n        }\n\n        searchImage(params);\n    });\n"],"names":["formElement","inputElement","loadButton","galleryElement","loadingContainer","pageNumber","perPage","inputValue","totalHits","api","axios","getGalleryCardHeight","smoothScrollBy","height","searchImage","params","response","hits","newTotalHits","rendedImages","html","largeImageURL","webformatURL","tags","likes","views","comments","downloads","SimpleLightbox","cardHeight","iziToast","error","loadMoreImages","searchParams","event"],"mappings":"owBAQA,MAAMA,EAAc,SAAS,cAAc,OAAO,EAC5CC,EAAe,SAAS,cAAc,aAAa,EACnDC,EAAa,SAAS,cAAc,WAAW,EAC/CC,EAAiB,SAAS,cAAc,UAAU,EAClDC,EAAmB,SAAS,cAAc,oBAAoB,EAEpE,IAAIC,EAAa,EACbC,EAAU,GACVC,EAAa,GACbC,EAAY,EAEhB,MAAMC,EAAMC,EAAM,OAAO,CACrB,QAAS,2BACT,OAAQ,CACJ,IAAK,qCACL,EAAG,GACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAML,EACN,SAAUC,CACb,CACL,CAAC,EAED,SAASK,GAAuB,CAG5B,OAFoB,SAAS,cAAc,eAAe,EAC5B,wBACb,MACrB,CAEA,SAASC,EAAeC,EAAQ,CAC5B,OAAO,SAAS,CACZ,IAAKA,EACL,SAAU,QAClB,CAAK,CACL,CAEA,eAAeC,EAAYC,EAAQ,CAE/B,GAAI,CACA,MAAMC,EAAW,MAAMP,EAAI,IAAI,GAAI,CAC/B,OAAQM,CACpB,CAAS,EAEK,CAAE,KAAAE,EAAM,UAAWC,CAAY,EAAKF,EAAS,KAE/C,GAAGC,EAAK,OAAS,EAAG,CACrB,MAAME,EAAeF,EAAK,OAAO,CAACG,EACjC,CAAC,cAAAC,EAAe,aAAAC,EAAc,KAAAC,EAAM,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,CAAS,IAC9DP,EAAO;AAAA;AAAA,+BAEKC;AAAA,qDACsBC,WAAsBC;AAAA;AAAA,wDAEnBC;AAAA,wDACAC;AAAA,2DACGC;AAAA,4DACCC;AAAA;AAAA;AAAA,uBAI7C,EAAE,EAiBL,GAfAxB,EAAe,mBAAmB,YAAagB,CAAY,EAClC,IAAIS,EAAgB,aAAc,CACvD,YAAa,OACb,aAAc,MACd,aAAc,IACd,gBAAiB,SACjB,MAAO,GACP,eAAgB,GAChB,SAAU,EAC1B,CAAa,EAEgB,QAAO,EACxBvB,GAAc,EACdH,EAAW,MAAM,QAAU,OAEvBG,EAAa,EAAG,CAChB,MAAMwB,EAAalB,IACnBC,EAAe,EAAIiB,CAAU,CAChC,CAEDrB,EAAYU,EAERb,GAAc,KAAK,KAAKG,EAAYF,CAAO,IAE3CJ,EAAW,MAAM,QAAU,OAE3B4B,EAAS,KAAK,CACV,SAAU,WACV,QAAS,4DAC7B,CAAiB,EAGjB,MACYA,EAAS,MAAM,CACX,SAAU,WACV,QAAS,0EACzB,CAAa,EAED5B,EAAW,MAAM,QAAU,MAE9B,OAAQ6B,EAAN,CACCD,EAAS,MAAM,CACX,MAAO,QACP,QAASC,EAAM,QACf,SAAU,UAC1B,CAAa,CACJ,QACO,CACJ3B,EAAiB,MAAM,QAAU,MACpC,CAET,CAEI,SAAS4B,GAAiB,CACtBzB,EAAaN,EAAa,MAAM,OAChC,MAAMgC,EAAe,IAAI,gBAAgB,CACrC,GAAGxB,EAAI,SAAS,OAChB,KAAMJ,EACN,EAAGE,CACf,CAAS,EAEDH,EAAiB,MAAM,QAAU,OACjCF,EAAW,MAAM,QAAU,OAE3BY,EAAYmB,CAAY,CAC3B,CAGD/B,EAAW,iBAAiB,QAAS8B,CAAc,EAGnDhC,EAAY,iBAAiB,SAAUkC,GAAS,CAC5CA,EAAM,eAAc,EAEpB/B,EAAe,UAAY,GAGxBA,EAAe,YAAc,KAC5BC,EAAiB,MAAM,QAAU,QAGrCC,EAAa,EAEbE,EAAaN,EAAa,MAAM,OAChCC,EAAW,MAAM,QAAU,OAE3B,MAAMa,EAAS,CACX,GAAGN,EAAI,SAAS,OAChB,EAAGF,EACH,KAAMF,CACT,EAEDS,EAAYC,CAAM,CAC1B,CAAK"}